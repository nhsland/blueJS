Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);const bluejay=(function(){"use strict";const e={};let t=1;return e.extend=((n,o)=>o.id||n in e?(bluejay.log('** Err: Can not extend again: "'+n+'"'),!1):(o.id=t++,e[n]=o,!0)),e.log=function(e){console.log("[blue] "+e)},e.log("OE JS UI layer... ready"),e.log("DEBUG MODE"),document.addEventListener("DOMContentLoaded",()=>{let t=[];for(const n in e)t.push(n);e.log("[API] "+t.join(", "))},{once:!0}),e})();!(function(e){"use strict";const t=[],n=[],o=[],i=[],s=[],l=(e,t,n)=>{e.push({selector:t,cb:n})},a=(e,t)=>{e.target!==document&&t.forEach(t=>{e.target.matches(t.selector)&&(t.cb(e),e.stopPropagation())})},r=e=>{e.forEach(e=>{e.cb(event)})};function c(e){let t=!1;return()=>{if(t)return;t=!0,r(e);let n=setTimeout(()=>{clearTimeout(n),t=!1},320)}}const d=c(i),p=c(s);document.addEventListener("DOMContentLoaded",()=>{document.addEventListener("mouseenter",e=>a(e,n),!0),document.addEventListener("mousedown",e=>a(e,t),!1),document.addEventListener("mouseleave",e=>a(e,o),!0),window.addEventListener("scroll",()=>d(),!0),window.onresize=(()=>p())}),e.extend("registerForHover",(e,t)=>l(n,e,t)),e.extend("registerForClick",(e,n)=>l(t,e,n)),e.extend("registerForExit",(e,t)=>l(o,e,t)),e.extend("listenForScroll",e=>l(i,null,e)),e.extend("listenForResize",e=>l(s,null,e))})(bluejay),(function(e){"use strict";bluejay.extend("triggerCustomEvent",(e,t)=>{e="oeui-"+e;const n=new CustomEvent(e,{detail:t});document.dispatchEvent(n),bluejay.log('[Custom Event] - "'+e+'"')})})(),(function(e){"use strict";e.extend("nodeArray",e=>Array.prototype.slice.call(e)),e.extend("appendTo",(e,t,n)=>{(n||document).querySelector(e).appendChild(t)}),e.extend("removeElement",e=>{e.parentNode.removeChild(e)}),e.extend("xhr",t=>(e.log("[XHR] - "+t),new Promise((n,o)=>{let i=new XMLHttpRequest;i.open("GET",t),i.onreadystatechange=function(){4===i.readyState&&(i.status>=200&&i.status<300?(e.log("[XHR] - Success"),n(i.responseText)):(e.log("[XHR] - Failed"),o(this.status+" "+this.statusText)))},i.send()}))),e.extend("getHiddenElemSize",e=>{e.style.visibility="hidden",e.style.display="block";let t={w:e.offsetWidth,h:e.offsetHeight};return e.style.visibility="inherit",e.style.display="none",t})})(bluejay),(function(e){"use strict";const t={};e.extend("addModule",(n,o)=>n in t?(e.log("** Err: Module aleady added? "+n),!1):(e.log("[Module] "+n),t[n]={},t[n])),e.extend("getModule",n=>{if(n in t)return t[n];e.log("Module does not exist?: "+n)})})(bluejay),(function(e){"use strict";const t={css:{extendedBrowserSize:1440,browserHotlistFixSize:1890}};e.extend("getSetting",(function(e){return t[e]})),e.extend("getDataAttributeName",(e=!1)=>{return"data-"+(!1===e?"oeui":"oeui-"+e)})})(bluejay),(function(e){"use strict";let t=bluejay.nodeArray(document.querySelectorAll(".hidden"));t.length<1||t.forEach(e=>{e.style.display="none",e.classList.remove("hidden")})})(),(function(e){"use strict";e.addModule("tooltip");let t=!1,n=window.innerWidth,o=document.createElement("div");o.className="oe-tooltip",o.style.display="none",e.appendTo("body",o);const i=i=>{if(t)return;t=!0;const s=i.target;o.innerHTML=s.dataset.tooltipContent;let l=100,a="",r=e.getHiddenElemSize(o).h,c=s.getBoundingClientRect(),d=c.right-c.width/2,p=c.top-r-8+"px",u=e.getSetting("css").extendedBrowserSize;d<=l?(l=20,a="offset-right"):d>(n>u?u:n)-l&&(l=180,a="offset-left"),c.top<r&&(p=c.bottom+8+"px",a="inverted"),o.className="oe-tooltip "+a,o.style.top=p,o.style.left=d-l+"px",o.style.display="block"},s=e=>{t&&(t=!1,o.innerHTML="",o.className="oe-tooltip",o.style.cssText="display:none")};e.registerForClick(".js-has-tooltip",e=>t?s(e):i(e)),e.registerForHover(".js-has-tooltip",i),e.registerForExit(".js-has-tooltip",s),e.listenForScroll(s),e.listenForResize(()=>n=window.innerWidth)})(bluejay),(function(e){"use strict";e.addModule("attachmentThumbnail");const t="oe-attachment-thumbnail";let n,o=!1;const i={};if(e.nodeArray(document.querySelectorAll("."+t)).length<1)return;const s=()=>{i.close.removeEventListener("mousedown",s),i.save&&(i.save.removeEventListener("mousedown",s),i.cancel.removeEventListener("mousedown",s)),e.removeElement(n),o=!1},l=t=>{o||(t=>{o=!0,(n=document.createElement("div")).className="oe-popup-wrap";let l='<div class="oe-popup-attachment">';l+='<div class="title">'+t.title+"</div>",l+='<div class="close-icon-btn"><i class="oe-i remove-circle pro-theme"></i></div>',l+='<div class="file-attachment-content"></div>',l+='<div class="file-size-controls"></div>',l+="</div>",n.innerHTML=l;const a=n.querySelector(".file-attachment-content"),r=n.querySelector(".file-size-controls"),c=new DocumentFragment,d=(e,t,n=!1)=>{let o=document.createElement("button");return o.className=t,n&&(o.id=n),o.textContent=e,c.appendChild(o),o};if("png"===t.type){let e="url('"+t.file+"')";a.style.backgroundImage=e,a.innerHTML='<img src="'+t.file+'" style="display:none"/>';const o=n.querySelector("img"),i=d("Fit to screen","pro-theme selected","oe-att-fit"),s=d("Actual size","pro-theme","oe-att-actual"),l=(e,t,n,i)=>{a.style.backgroundImage=e,o.style.display=t,n.classList.add("selected"),i.classList.remove("selected")};s.addEventListener("mousedown",e=>{e.stopPropagation(),l("none","block",s,i)}),i.addEventListener("mousedown",t=>{t.stopPropagation(),l(e,"none",i,s)})}else a.innerHTML='<embed src="'+t.file+'" width="100%" height="100%"></embed>',d("PDF","pro-theme selected");if(t.annotate){a.classList.add("annotation");let o=document.createElement("div");o.className="attachment-annotation",e.appendTo(".oe-popup-attachment",o,n),e.xhr(t.idgPHP).then(e=>{o.innerHTML=e,"L"==t.eyelat&&(o.querySelector("#annotation-right").style.visibility="hidden"),"R"==t.eyelat&&(o.querySelector("#annotation-left").style.visibility="hidden")}).catch(e=>console.log("XHR failed: ",e)),i.save=d("Save annotations","green hint"),i.cancel=d("Cancel","red hint"),i.save.addEventListener("mousedown",s,{once:!0}),i.cancel.addEventListener("mousedown",s,{once:!0})}if(t.stack){let o=t.title.split(" - "),i="<option>"+t.title+"</option>";for(let e=t.stack;e;e--)i+="<option>"+o[0]+" - ("+e+" Jan 1975 09:30)</option>";let s=document.createElement("div");s.className="attachment-stack",s.innerHTML='Choose report: <select class="pro-theme">'+i+"</select>",e.appendTo(".oe-popup-attachment",s,n)}i.close=n.querySelector(".close-icon-btn"),i.close.addEventListener("mousedown",s,{once:!0}),r.appendChild(c),e.appendTo("body",n)})(JSON.parse(t.target.dataset.attachment))};e.registerForClick("."+t,l),document.querySelectorAll(".js-annotate-attachment")&&e.registerForClick(".js-annotate-attachment",l)})(bluejay),(function(e){"use strict";e.addModule("collapseData");const t="collapse-data-header-icon",n=[];function o(e){this.btn=e,this.content=e.parentNode.querySelector(".collapse-data-content"),this.collapsed=!0,this.change()}o.prototype.change=function(){this.collapsed?this.view("block","collapse"):this.view("none","expand"),this.collapsed=!this.collapsed},o.prototype.view=function(e,n){this.content.style.display=e,this.btn.className=t+n};e.registerForClick("."+t,t=>{let i=t.target,s=e.getDataAttributeName();if(!1===i.hasAttribute(s))i.setAttribute(s,n.length),n.push(new o(i));else{let e=i.dataset[s.substring(5)];n[e].change()}})})(bluejay),(function(e){"use strict";e.addModule("overlayPopup");const t=[{id:"#js-change-context-btn",php:"change-context.php",close:".close-icon-btn"},{id:"#copy-edit-history-btn",php:"previous-history-elements.php",close:".close-icon-btn"},{id:"#copy-edit-anterior-segment-btn",php:"previous-ed-anterior.php",close:".close-icon-btn"},{id:"#js-virtual-clinic-btn",php:"virtual-clinic.php",close:".close-icon-btn"},{id:"#js-delete-event-btn",php:"delete-event.php",close:".js-demo-cancel-btn"},{id:"#js-close-element-btn",php:"close-element.php",close:".js-demo-cancel-btn"},{id:"#js-add-new-event",php:"add-new-event.php",close:".close-icon-btn"},{id:"#js-idg-preview-correspondence",php:"letter-preview.php",close:".close-icon-btn"},{id:"#js-idg-exam-complog",php:"exam-va-COMPlog.php",close:".close-icon-btn"},{id:"#js-duplicate-event-btn",php:"duplicate-event-warning.php",close:".close-icon-btn"},{id:"#js-idg-worklist-ps-add",php:"worklist-PS.php",close:".close-icon-btn"},{id:"#analytics-change-filters",php:"analytics-filters.php",close:".close-icon-btn"},{id:"#js-idg-add-new-contact-popup",php:"add-new-contact.php",close:".close-icon-btn"}],n=(t,n,o)=>{e.registerForClick(t,()=>{e.xhr("/idg-php/v3/_load/"+n).then(t=>{const n=document.createElement("div");n.className="oe-popup-wrap",n.innerHTML=t,n.querySelector(o).addEventListener("mousedown",t=>{t.stopPropagation(),e.removeElement(n)},{once:!0}),e.appendTo("body",n)}).catch(e=>console.log("overlayPopup failed to load",e))})};for(let e=0,o=t.length;e<o;e++){let o=t[e];null!==document.querySelector(o.id)&&n(o.id,o.php,o.close)}})(bluejay),(function(e){"use strict";e.addModule("proView");const t=e.getDataAttributeName(),n=[],o=e=>({options:function(e){e.lock&&(this.pro=null),0!=e.linkID&&(this.linked=!0,this.linkedProView=s(document.querySelector("#"+e.linkID)),e.lock&&(this.linkedProView.pro=null))}}),i=e=>{if(!e.classList.contains("pro-data-view"))return;let t=e.querySelector(".pro-view-btn"),n=e.querySelector(".data-pro-view"),i=e.querySelector(".data-standard-view"),s={btn:t,oei:t.querySelector(".oe-i"),pro:n,standard:i,inPro:!0,linked:!1};return Object.assign(s,{change:function(){this.inPro?(this.hideShow(this.pro,this.standard),this.icon("expand","collapse")):(this.hideShow(this.standard,this.pro),this.icon("collapse","expand")),this.linked&&this.linkedProView.change(),this.inPro=!this.inPro}},{hideShow:function(e,t){e&&(e.style.display="none"),t&&(t.style.display="block")}},{icon:function(e,t){this.oei.classList.replace(e,t)}},o())},s=e=>{let t={pro:e.querySelector(".data-pro-view"),standard:e.querySelector(".data-standard-view"),inPro:!0};return Object.assign(t,{change:function(){this.inPro?this.hideShow(this.pro,this.standard):this.hideShow(this.standard,this.pro),this.inPro=!this.inPro}},{hideShow:function(e,t){e&&(e.style.display="none"),t&&(t.style.display="block")}})};e.registerForClick(".pro-view-btn",e=>{const o=e.target;if(!1===o.hasAttribute(t)){o.setAttribute(t,n.length);let e=i(o.parentNode);e.options(JSON.parse(o.dataset.proview)),e.change(),n.push(e)}else{let e=o.dataset[t.substring(5)];n[e].change()}})})(bluejay),(function(e){"use strict";e.addModule("restrictDataHeightFlag");const t="restrict-data-shown-flag",n=e.getDataAttributeName(),o=[];function i(e,t,n){this.hasScrolled=!1,this.flag=e,this.content=t,this.scrollEndPos=n,this.content.addEventListener("scroll",()=>this.scroll(),{once:!0})}i.prototype.scroll=function(t){this.hasScrolled=!0,this.flag.className+=" fade-out",setTimeout(()=>e.removeElement(this.flag),400)},i.prototype.userClick=function(){this.hasScrolled||s(this.content,this.scrollEndPos)};const s=(e,t)=>{let n=1,o=0,i=setInterval(()=>{o=Math.min(1,n/200),e.scrollTop=Math.ceil((e=>e*(2-e))(o)*t),n+=1,1==o&&clearInterval(i)},2)};(()=>{let s=e.nodeArray(document.querySelectorAll(".restrict-data-shown"));if(s.length<1)return;const l=document.createDocumentFragment(),a=document.createElement("div");a.className=t,l.appendChild(a),s.forEach(e=>{let t=e.querySelector(".restrict-data-content"),s=e.clientHeight,a=t.scrollHeight;if(a>s&&0===t.scrollTop){let r=l.cloneNode(!0),c=r.firstChild;c.setAttribute(n,o.length),e.appendChild(r),o.push(new i(c,t,a-s))}})})(),e.registerForClick("."+t,e=>{o[e.target.getAttribute(n)].userClick()})})(bluejay),(function(e){"use strict";bluejay.addModule("textAreaResize"),document.addEventListener("input",e=>{e.target.matches("textarea")&&(e.target.style.height="auto",e.target.style.height=e.target.scrollHeight+"px")},!0)})();