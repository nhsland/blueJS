Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);const bluejay=(function(){"use strict";console.time("[blue] Ready"),console.time("[blue] DOM Loaded");const e={};let t=1;return e.extend=((n,s)=>s._app||n in e?(bluejay.log('** Err: Can not extend again: "'+n+'"'),!1):(s._app=t++,e[n]=s,!0)),e.log=function(e){console.log("[blue] "+e)},e.log("OE JS UI layer... starting"),e.log("DEBUG MODE"),document.addEventListener("DOMContentLoaded",()=>{let t=[];for(const n in e)t.push(n);e.log("[API] [Helper Methods] "+t.join(", ")),console.timeEnd("[blue] DOM Loaded")},{once:!0}),e})();!(function(e){"use strict";const t=[],n=[],s=[],i=[],o=(e,t,n)=>{e.push({selector:t,cb:n})},a=(e,t)=>{e.target!==document&&t.forEach(t=>{e.target.matches(t.selector)&&t.cb(e)})},r=e=>{e.forEach(e=>{e.cb()})};const l=(function(e){let t=!1;return()=>{t||(t=!0,setTimeout(()=>{t=!1,r(e)},160))}})(i);document.addEventListener("mouseenter",e=>a(e,n),{capture:!0}),document.addEventListener("mousedown",e=>a(e,t),{capture:!0}),document.addEventListener("mouseleave",e=>a(e,s),{capture:!0}),window.onresize=l,e.extend("registerForHover",(e,t)=>o(n,e,t)),e.extend("registerForClick",(e,n)=>o(t,e,n)),e.extend("registerForExit",(e,t)=>o(s,e,t)),e.extend("listenForResize",e=>o(i,null,e))})(bluejay),(function(e){"use strict";bluejay.extend("triggerCustomEvent",(e,t)=>{const n=new CustomEvent("blue-"+e,{detail:t});document.dispatchEvent(n),bluejay.log('[Custom Event] - "'+e+'"')})})(),(function(e){"use strict";e.extend("nodeArray",e=>Array.prototype.slice.call(e)),e.extend("appendTo",(e,t,n)=>{(n||document).querySelector(e).appendChild(t)}),e.extend("getParent",(e,t)=>{for(;!e.matches("body");){if(e.matches(t))return e;e=e.parentNode}return!1}),e.extend("removeElement",e=>{e.parentNode.removeChild(e)}),e.extend("show",(e,t="block")=>{e.style.display=t}),e.extend("reshow",e=>{e.style.display=""}),e.extend("hide",e=>{e.style.display="none"}),e.extend("xhr",t=>(e.log("[XHR] - "+t),new Promise((n,s)=>{let i=new XMLHttpRequest;i.open("GET",t),i.onreadystatechange=function(){4===i.readyState&&(i.status>=200&&i.status<300?(e.log("[XHR] - Success"),n(i.responseText)):(e.log("[XHR] - Failed"),s(this.status+" "+this.statusText)))},i.send()}))),e.extend("getHiddenElemSize",e=>{e.style.visibility="hidden",e.style.display="";let t={w:e.offsetWidth,h:e.offsetHeight};return e.style.visibility="inherit",e.style.display="none",t})})(bluejay),(function(e){"use strict";const t=new Map;let n=n=>t.has(n)?t.get(n):(e.log("Module does not exist?: "+n),!1);e.extend("addModule",(s,i)=>t.has(s)?(e.log("** Err: Module aleady added? "+s),!1):(e.log("[Module] "+s),t.set(s,{}),n(s))),e.extend("getModule",n)})(bluejay),(function(e){"use strict";const t={get cssTopBarHeight(){return 60},get cssExtendBrowserSize(){return 1890},get cssBrowserHotlistFixSize(){return 1440},get PHPLOAD(){return"/idg-php/v3/_load/"}},n=(e=!1)=>{return"data-"+(e?"bluejay-"+e:"bluejay")};e.extend("settings",t),e.extend("getDataAttributeName",n),e.extend("setDataAttr",(e,t)=>{e.setAttribute(n(),t)}),e.extend("getDataAttr",e=>{const t=n();return!!e.hasAttribute(t)&&e.getAttribute(t)})})(bluejay),(function(e){"use strict";e.addModule("collapseExpand");const t=[],n=()=>({show:function(){e.show(this.content),this.btn.classList.replace("expand","collapse"),this.open=!0}}),s=()=>({hide:function(){e.hide(this.content),this.btn.classList.replace("collapse","expand"),this.open=!1}}),i=e=>Object.assign(e,{change:function(){this.open?this.hide():this.show()}},n(),s()),o=(n,s)=>{let o=n.target,a=e.getDataAttr(o);if(a)t[parseFloat(a)].change();else{e.setDataAttr(o,t.length);let n={btn:o,content:o.parentNode.querySelector(".collapse-"+s+"-content"),open:o.classList.contains("collapse")},a=i(n);a.change(),t.push(a)}};e.registerForClick(".collapse-data-header-icon",e=>o(e,"data")),e.registerForClick(".collapse-group > .header-icon",e=>o(e,"group"))})(bluejay),(function(e){"use strict";const t=e.nodeArray(document.querySelectorAll(".hidden"));t.length<1||t.forEach(t=>{e.hide(t),t.classList.remove("hidden")})})(bluejay),(function(e){"use strict";e.addModule("patientQuickMeta");let t=!1,n=!1,s=null,i=null,o=null,a=window.innerHeight;const r={},l=()=>{i.style.display="none",t=n=!1,s=null},d=(l,d)=>{if(s===l&&t)return n=!0,void e.show(o);i=i||(()=>{const t=document.createElement("div");return t.className="oe-patient-quick-overview",t.style.display="none",t.innerHTML=['<div class="close-icon-btn"><i class="oe-i remove-circle medium"></i></div>','<div class="oe-patient-meta">','<div class="patient-name">','<a href="/v3-SEM/patient-overview"><span class="patient-surname">SURNAME</span>, <span class="patient-firstname">First (M.)</span></a>','</div><div class="patient-details">','<div class="hospital-number"><span>ID</span>0000000</div>','<div class="nhs-number"><span>NHS</span>111 222 3333</div>','<div class="patient-gender"><em>Gen</em>Male</div>','<div class="patient-age"><em>Age</em>00y</div>',"</div></div>",'<div class="quick-overview-content"></div>'].join(""),e.appendTo("body",t),o=t.querySelector(".close-icon-btn"),r.surname=t.querySelector(".patient-surname"),r.first=t.querySelector(".patient-firstname"),r.hospital=t.querySelector(".hospital-number"),r.nhs=t.querySelector(".nhs-number"),r.gender=t.querySelector(".patient-gender"),r.age=t.querySelector(".patient-age"),t})(),t=!0,n=d,s=l;let c=l.dataset,u=l.getBoundingClientRect(),p=c.mode,h=c.php,g=JSON.parse(c.patient);r.surname.textContent=g.surname,r.first.textContent=g.first,r.hospital.innerHTML="<span>ID</span> "+g.id,r.nhs.innerHTML="<span>NHS</span> "+g.nhs,r.gender.innerHTML="<em>Gen</em> "+g.gender,r.age.innerHTML="<em>Age</em> "+g.age,i.style.cssText=" ","float"==p?(i.classList.remove("side-panel"),a-u.y>300?i.style.top=u.y+u.height+5+"px":i.style.bottom=a-u.top+10+"px",i.style.left=u.x-250+u.width/2+"px"):i.classList.add("side-panel");let y=i.querySelector(".quick-overview-content");y.innerHTML="";let m=setTimeout(()=>y.innerHTML='<i class="spinner"></i>',400);d?e.show(o):e.hide(o),e.xhr("/idg-php/v3/_load/"+h).then(e=>{clearTimeout(m),t&&(y.innerHTML=e,i.style.display="block")}).catch(e=>console.log("ed3app php failed to load",e))};e.registerForClick(".js-patient-quick-overview",e=>{let i=e.target;t&&n&&s===i?l():d(i,!0)}),e.registerForHover(".js-patient-quick-overview",e=>{n||d(e.target,!1)}),e.registerForExit(".js-patient-quick-overview",e=>{n||l()}),e.registerForClick(".oe-patient-quick-overview .close-icon-btn .oe-i",l),e.listenForResize(()=>a=window.inneHeight)})(bluejay),(function(e){"use strict";e.addModule("tooltip");let t=null,n=!1,s=window.innerWidth,i=null;const o=200,a=400,r=()=>{t.innerHTML="",t.className="oe-tooltip",t.style.cssText="display:none"},l=()=>{n&&(n=!1,r())},d=i=>{if(n)return;n=!0;const d=i.target;t=t||(()=>(t=document.createElement("div"),e.appendTo("body",t),r(),t))();let c=o,u="block";"bilateral"===d.dataset.ttType?(t.classList.add("bilateral"),"no"===d.dataset.ttEyeicons&&t.classList.add("no-icons"),t.innerHTML='<div class="right"></div><div class="left"></div>',t.querySelector(".right").innerHTML=d.dataset.ttRight,t.querySelector(".left").innerHTML=d.dataset.ttLeft,u="flex",c=a):t.innerHTML=d.dataset.tooltipContent;let p=c/2,h=e.getHiddenElemSize(t).h,g=d.getBoundingClientRect(),y=g.right-g.width/2,m=g.top-h-8,v=e.settings.cssExtendBrowserSize,b=s>v?v:s;y<=p&&(p=20,t.classList.add("offset-right")),y>b-p&&(p=c-20,t.classList.add("offset-left")),g.top<h&&(m=g.bottom+8,t.classList.add("inverted")),t.style.top=m+"px",t.style.left=y-p+"px",t.style.display=u,window.addEventListener("scroll",l,{capture:!0,once:!0})};e.registerForClick(".js-has-tooltip",e=>{e.target.isSameNode(i)?n?l():d(e):(l(),d(e)),i=e.target}),e.registerForHover(".js-has-tooltip",d),e.registerForExit(".js-has-tooltip",l),e.listenForResize(()=>s=window.innerWidth)})(bluejay),(function(e){"use strict";console.timeEnd("[blue] Ready")})();