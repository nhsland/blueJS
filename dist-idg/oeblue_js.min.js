Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);const bluejay=(function(){"use strict";console.time("[blue] Ready");const e={};let t=1;return e.extend=((n,o)=>o._app||n in e?(bluejay.log('** Err: Can not extend again: "'+n+'"'),!1):(o._app=t++,e[n]=o,!0)),e.log=function(e){console.log("[blue] "+e)},e.log("OE JS UI layer... starting"),e.log("DEBUG MODE"),document.addEventListener("DOMContentLoaded",()=>{let t=[];for(const n in e)t.push(n);e.log("[API] [Helper Methods] "+t.join(", ")),console.timeEnd("[blue] Ready")},{once:!0}),e})();!(function(e){"use strict";const t=[],n=[],o=[],s=[],i=[],l=(e,t,n)=>{e.push({selector:t,cb:n})},a=(e,t)=>{e.target!==document&&t.forEach(t=>{e.target.matches(t.selector)&&t.cb(e)})},r=e=>{e.forEach(e=>{e.cb(event),event.stopPropagation()})};function c(e){let t=!1;return()=>{t||(t=!0,r(e),setTimeout(()=>{t=!1},320))}}const d=c(s),u=c(i);document.addEventListener("DOMContentLoaded",()=>{document.addEventListener("mouseenter",e=>a(e,n),{capture:!0}),document.addEventListener("mousedown",e=>a(e,t),{capture:!1}),document.addEventListener("mouseleave",e=>a(e,o),{capture:!0}),window.addEventListener("scroll",()=>d(),!0),window.onresize=(()=>u())},{once:!0}),e.extend("registerForHover",(e,t)=>l(n,e,t)),e.extend("registerForClick",(e,n)=>l(t,e,n)),e.extend("registerForExit",(e,t)=>l(o,e,t)),e.extend("listenForScroll",e=>l(s,null,e)),e.extend("listenForResize",e=>l(i,null,e))})(bluejay),(function(e){"use strict";bluejay.extend("triggerCustomEvent",(e,t)=>{e="oeui-"+e;const n=new CustomEvent(e,{detail:t});document.dispatchEvent(n),bluejay.log('[Custom Event] - "'+e+'"')})})(),(function(e){"use strict";e.extend("nodeArray",e=>Array.prototype.slice.call(e)),e.extend("appendTo",(e,t,n)=>{(n||document).querySelector(e).appendChild(t)}),e.extend("getParent",(e,t)=>{for(;!e.matches("body");){if(e.matches(t))return e;e=e.parentNode}return!1}),e.extend("removeElement",e=>{e.parentNode.removeChild(e)}),e.extend("xhr",t=>(e.log("[XHR] - "+t),new Promise((n,o)=>{let s=new XMLHttpRequest;s.open("GET",t),s.onreadystatechange=function(){4===s.readyState&&(s.status>=200&&s.status<300?(e.log("[XHR] - Success"),n(s.responseText)):(e.log("[XHR] - Failed"),o(this.status+" "+this.statusText)))},s.send()}))),e.extend("getHiddenElemSize",e=>{e.style.visibility="hidden",e.style.display="block";let t={w:e.offsetWidth,h:e.offsetHeight};return e.style.visibility="inherit",e.style.display="none",t})})(bluejay),(function(e){"use strict";const t={};e.extend("addModule",(n,o)=>n in t?(e.log("** Err: Module aleady added? "+n),!1):(e.log("[Module] "+n),t[n]={},t[n])),e.extend("getModule",n=>{if(n in t)return t[n];e.log("Module does not exist?: "+n)})})(bluejay),(function(e){"use strict";const t={get cssTopBarHeight(){return 60},get cssExtendBrowserSize(){return 1890},get cssBrowserHotlistFixSize(){return 1440}},n=(e=!1)=>{return"data-"+(e?"bluejay-"+e:"bluejay")};e.extend("settings",t),e.extend("getDataAttributeName",n),e.extend("setDataAttr",(e,t)=>{e.setAttribute(n(),t)}),e.extend("getDataAttr",e=>{const t=n();return e.hasAttribute(t)?e.getAttribute(t):null})})(bluejay),(function(e){"use strict";e.addModule("collapseExpand");const t=[],n={selector:".collapse-data-header-icon",btn:"collapse-data-header-icon",content:".collapse-data-content"},o={selector:".collapse-group > .header-icon",btn:"header-icon",content:".collapse-group-content"},s=e=>Object.assign(e,{change:function(){this.collapsed?this.view("block","collapse"):this.view("none","expand"),this.collapsed=!this.collapsed}},{view:function(e,t){this.content.style.display=e,this.btn.className=[this.btnCSS,t].join(" ")}}),i=(n,o)=>{let i=n.target,l=e.getDataAttr(i);if(l)t[parseFloat(l)].change();else{let n=s({btn:i,btnCSS:o.btn,content:i.parentNode.querySelector(o.content),collapsed:i.classList.contains("expand")});n.change(),e.setDataAttr(i,t.length),t.push(n)}};e.registerForClick(n.selector,e=>i(e,n)),e.registerForClick(o.selector,e=>i(e,o))})(bluejay),(function(e){"use strict";let t=bluejay.nodeArray(document.querySelectorAll(".hidden"));t.length<1||t.forEach(e=>{e.style.display="none",e.classList.remove("hidden")})})(),(function(e){"use strict";e.addModule("tooltip");let t=!1,n=window.innerWidth,o=document.createElement("div");o.className="oe-tooltip",o.style.display="none",e.appendTo("body",o);const s=s=>{if(t)return;t=!0;const i=s.target;o.innerHTML=i.dataset.tooltipContent;let l=100,a="",r=e.getHiddenElemSize(o).h,c=i.getBoundingClientRect(),d=c.right-c.width/2,u=c.top-r-8+"px",p=e.settings.cssExtendBrowserSize;d<=l?(l=20,a="offset-right"):d>(n>p?p:n)-l&&(l=180,a="offset-left"),c.top<r&&(u=c.bottom+8+"px",a="inverted"),o.className="oe-tooltip "+a,o.style.top=u,o.style.left=d-l+"px",o.style.display="block"},i=e=>{t&&(t=!1,o.innerHTML="",o.className="oe-tooltip",o.style.cssText="display:none")};e.registerForClick(".js-has-tooltip",e=>t?i(e):s(e)),e.registerForHover(".js-has-tooltip",s),e.registerForExit(".js-has-tooltip",i),e.listenForScroll(i),e.listenForResize(()=>n=window.innerWidth)})(bluejay),(function(e){"use strict";e.addModule("attachmentThumbnail");const t="oe-attachment-thumbnail";let n,o=!1;const s={};if(e.nodeArray(document.querySelectorAll("."+t)).length<1)return;const i=()=>{s.close.removeEventListener("mousedown",i),s.save&&(s.save.removeEventListener("mousedown",i),s.cancel.removeEventListener("mousedown",i)),e.removeElement(n),o=!1},l=t=>{o||(t=>{o=!0,(n=document.createElement("div")).className="oe-popup-wrap";let l='<div class="oe-popup-attachment">';l+='<div class="title">'+t.title+"</div>",l+='<div class="close-icon-btn"><i class="oe-i remove-circle pro-theme"></i></div>',l+='<div class="file-attachment-content"></div>',l+='<div class="file-size-controls"></div>',l+="</div>",n.innerHTML=l;const a=n.querySelector(".file-attachment-content"),r=n.querySelector(".file-size-controls"),c=new DocumentFragment,d=(e,t,n=!1)=>{let o=document.createElement("button");return o.className=t,n&&(o.id=n),o.textContent=e,c.appendChild(o),o};if("png"===t.type){let e="url('"+t.file+"')";a.style.backgroundImage=e,a.innerHTML='<img src="'+t.file+'" style="display:none"/>';const o=n.querySelector("img"),s=d("Fit to screen","pro-theme selected","oe-att-fit"),i=d("Actual size","pro-theme","oe-att-actual"),l=(e,t,n,s)=>{a.style.backgroundImage=e,o.style.display=t,n.classList.add("selected"),s.classList.remove("selected")};i.addEventListener("mousedown",e=>{e.stopPropagation(),l("none","block",i,s)}),s.addEventListener("mousedown",t=>{t.stopPropagation(),l(e,"none",s,i)})}else a.innerHTML='<embed src="'+t.file+'" width="100%" height="100%"></embed>',d("PDF","pro-theme selected");if(t.annotate){a.classList.add("annotation");let o=document.createElement("div");o.className="attachment-annotation",e.appendTo(".oe-popup-attachment",o,n),e.xhr(t.idgPHP).then(e=>{o.innerHTML=e,"L"==t.eyelat&&(o.querySelector("#annotation-right").style.visibility="hidden"),"R"==t.eyelat&&(o.querySelector("#annotation-left").style.visibility="hidden")}).catch(e=>console.log("XHR failed: ",e)),s.save=d("Save annotations","green hint"),s.cancel=d("Cancel","red hint"),s.save.addEventListener("mousedown",i,{once:!0}),s.cancel.addEventListener("mousedown",i,{once:!0})}if(t.stack){let o=t.title.split(" - "),s="<option>"+t.title+"</option>";for(let e=t.stack;e;e--)s+="<option>"+o[0]+" - ("+e+" Jan 1975 09:30)</option>";let i=document.createElement("div");i.className="attachment-stack",i.innerHTML='Choose report: <select class="pro-theme">'+s+"</select>",e.appendTo(".oe-popup-attachment",i,n)}s.close=n.querySelector(".close-icon-btn"),s.close.addEventListener("mousedown",i,{once:!0}),r.appendChild(c),e.appendTo("body",n)})(JSON.parse(t.target.dataset.attachment))};e.registerForClick("."+t,l),document.querySelectorAll(".js-annotate-attachment")&&e.registerForClick(".js-annotate-attachment",l)})(bluejay),(function(e){"use strict";e.addModule("comments");e.registerForClick(".js-add-comments",e=>{const t=e.target,n=document.querySelector("#"+t.dataset.input);t.style.display="none",n.style.display="block",n.querySelector("textarea").focus(),n.querySelector(".js-remove-add-comments").addEventListener("mousedown",()=>{t.style.display="inline-block",n.style.display="none"},{once:!0})})})(bluejay),(function(e){"use strict";e.addModule("commentHotlist");const t=".oe-hotlist-panel .js-patient-comments",n=document.querySelector("#hotlist-quicklook"),o=t=>{return e.getParent(t,"tr").nextSibling.querySelector("textarea").value};e.registerForClick(t,t=>{const n=t.target,s=(o(n),e.getParent(n,"tr").nextSibling),i=s.querySelector("textarea");s.style.display="table-row",e.resizeTextArea(i)}),e.registerForHover(t,t=>{const s=t.target;let i=e.getParent(s,".patient-activity"),l=s.getBoundingClientRect().top-i.getBoundingClientRect().top+21;s.classList.contains("comments-added")&&(n.textContent=o(s),n.style.top=l+"px",n.style.display="block")}),e.registerForExit(t,()=>{n.style.display="none"})})(bluejay),(function(e){"use strict";e.addModule("elementSelector");const t=()=>({loadPHP:function(){e.xhr("/idg-php/v3/_load/sidebar/"+this.php).then(t=>{!1!==this.open&&(this.nav=document.createElement("nav"),this.nav.className=this.wrapClass,this.nav.innerHTML=t,this.btn.classList.add("selected"),e.appendTo("body",this.nav))}).catch(e=>console.log("PHP failed to load",e))}}),n=()=>({close:function(){this.open=!1,this.btn.classList.remove("selected"),e.removeElement(this.nav)}}),o=e=>(e.btn=null,e.open=!1,Object.assign(e,{change:function(e){null===this.btn&&(this.btn=e.target),this.open?this.close():(this.open=!0,this.loadPHP())}},t(),n()));if(null!==document.querySelector("#js-manage-elements-btn")){const t=o({wrapClass:"oe-element-selector",php:"element-selector.php"}),n=o({wrapClass:"sidebar element-overlay",php:"examination-elements.php"});e.registerForClick("#js-manage-elements-btn",e=>t.change(e)),e.registerForClick(".oe-element-selector .close-icon-btn button",()=>t.close()),e.registerForClick("#js-element-structure-btn",e=>n.change(e))}})(bluejay),(function(e){"use strict";e.addModule("elementTiles");const t=[],n=e=>{const t=e.querySelector(".element-title"),n=t.textContent,o=e.querySelector(".element-data"),s=o.querySelectorAll("tbody tr").length;return Object.assign({h3:t,title:n,content:o,count:s.toString()},{show:function(){this.h3.textContent=this.title,this.content.style.display="block"}},{hide:function(){this.h3.innerHTML=this.title+" <small>["+this.count+"]</small>",this.content.style.display="none"}})},o=e=>Object.assign({tiles:[],btn:e,collapsed:!1},{addTile:function(e){this.tiles.push(e)}},{change:function(){this.tiles.forEach(e=>{this.collapsed?(this.btn.classList.replace("increase-height","reduce-height"),e.show()):(this.btn.classList.replace("reduce-height","increase-height"),e.hide())}),this.collapsed=!this.collapsed}});e.registerForClick(".collapse-tile-group .oe-i",s=>{let i=e.getParent(s.target,".element-tile-group"),l=e.getDataAttr(i);if(l)t[parstFloat(l)].change();else{let l=o(s.target);e.nodeArray(i.querySelectorAll(".element.tile")).forEach(e=>{l.addTile(n(e))}),l.change(),e.getDataAttr(i,t.length),t.push(l)}})})(bluejay),(function(e){"use strict";e.addModule("eventAuditTrial");const t="#js-event-audit-trail-btn",n=document.querySelector(t);if(null===n)return;const o=document.querySelector("#js-event-audit-trail");null===o&&e.log("Audit Trail content not available in DOM?");let s=!1;const i=e=>{o.style.display="block",n.classList.add("active"),s=!0},l=e=>{o.style.display="none",n.classList.remove("active"),s=!1};e.registerForClick(t,e=>s?l(e):i(e)),e.registerForHover(t,i),e.registerForExit(t,l)})(bluejay),(function(e){"use strict";if(e.addModule("examElementSearch"),null===document.querySelector("#js-search-in-event-popup"))return;e.registerForClick("#js-search-in-event",e=>{const t=e.target,n=document.querySelector("#js-search-in-event-popup"),o=document.querySelector(".main-event"),s=n.querySelector(".close-icon-btn");t.classList.add("selected"),n.style.display="block",o.classList.add("examination-search-active"),s.addEventListener("mousedown",e=>{e.stopPropagation(),o.classList.remove("examination-search-active"),n.style.display="none",t.classList.remove("selected")},{once:!0})})})(bluejay),(function(e){"use strict";if(e.addModule("messagePreview"),null===document.querySelector(".home-messages"))return;e.registerForClick(".js-expand-message",t=>{let n=t.target,o=e.getParent(n,"tr").querySelector(".message");n.classList.contains("expand")?(o.classList.add("expand"),n.classList.replace("expand","collapse")):(o.classList.remove("expand"),n.classList.replace("collapse","expand"))})})(bluejay),(function(e){"use strict";e.addModule("navHotlist");const t="#js-nav-hotlist-btn",n=document.querySelector(t),o=(()=>Object.assign({btn:n,content:document.querySelector("#js-hotlist-panel"),wrapper:document.querySelector("#js-hotlist-panel-wrapper"),open:!1,isLocked:!1,isFixed:!1},{changeState:function(){this.isFixed||(this.open?this.isLocked?(this.isLocked=!1,this.hide()):this.makeLocked():(this.makeLocked(),this.over()))}},{over:function(){this.isFixed||(this.btn.classList.add("active"),this.show())}},{mouseOutHide:function(){this.wrapper.addEventListener("mouseleave",e=>{e.stopPropagation(),this.hide()},{once:!0})}},{makeLocked:function(){this.isLocked=!0,this.btn.classList.add("open")}},{show:function(){this.open||(this.open=!0,this.content.style.display="block",this.mouseOutHide())}},{hide:function(){!1===this.open||this.isLocked||this.isFixed||(this.open=!1,this.btn.classList.remove("active","open"),this.content.style.display="none")}},{fixedOpen:function(e){this.isFixed=e,e?(this.isLocked=!1,this.btn.classList.add("open"),this.btn.classList.remove("active"),this.show()):this.hide()}}))(),s=()=>{n.dataset.fixable&&o.fixedOpen(window.innerWidth>e.settings.cssExtendBrowserSize)};e.registerForClick(t,()=>o.changeState()),e.registerForHover(t,()=>o.over()),e.listenForResize(s),s()})(bluejay),(function(e){"use strict";e.addModule("navLogo");const t="#js-openeyes-btn",n=(()=>{let n=document.querySelector(t);return Object.assign({btn:n,content:document.querySelector("#js-openeyes-info"),wrapper:e.getParent(n,".openeyes-brand"),open:!1},{over:function(){this.btn.classList.add("active")}},{out:function(){this.btn.classList.remove("active")}},{change:function(){this.open?this.hide():this.show()}},{show:function(){this.open||(this.open=!0,this.btn.classList.add("open"),this.content.style.display="block",this.mouseOutHide())}},{hide:function(){!1!==this.open&&(this.open=!1,this.btn.classList.remove("open","active"),this.content.style.display="none")}},{mouseOutHide:function(){this.wrapper.addEventListener("mouseleave",e=>{e.stopPropagation(),this.hide()},{once:!0})}})})();e.registerForClick(t,()=>n.change()),e.registerForHover(t,()=>n.over()),e.registerForExit(t,()=>n.out())})(bluejay),(function(e){"use strict";e.addModule("navShortcuts");const t="#js-nav-shortcuts-btn",n=document.querySelector(t);if(null===n)return;const o=(()=>Object.assign({btn:n,content:document.querySelector("#js-nav-shortcuts-subnav"),wrapper:document.querySelector("#js-nav-shortcuts"),open:!1},{change:function(){this.open?this.hide():this.show()}},{show:function(){this.open||(this.open=!0,this.btn.classList.add("active"),this.content.style.display="block",this.mouseOutHide())}},{hide:function(){!1!==this.open&&(this.open=!1,this.btn.classList.remove("active"),this.content.style.display="none")}},{mouseOutHide:function(){this.wrapper.addEventListener("mouseleave",e=>{e.stopPropagation(),this.hide()},{once:!0})}}))();e.registerForClick(t,()=>o.change()),e.registerForHover(t,()=>o.show())})(bluejay),(function(e){"use strict";if(e.addModule("notificationBanner"),null===document.querySelector("#oe-admin-notifcation"))return;const t="#oe-admin-notifcation .oe-i",n=document.querySelector("#notification-short"),o=document.querySelector("#notification-full");if(null!==document.querySelector(".oe-login"))return n.style.display="none",o.style.display="block",void(document.querySelector(t).style.display="none");let s=n,i=o,l=!0;const a=(e,t)=>{e.style.display="block",t.style.display="none"};e.registerForHover(t,()=>a(i,s)),e.registerForExit(t,()=>a(s,i)),e.registerForClick(t,()=>{s=l?o:n,i=l?n:o,l=!l,a(s,i)})})(bluejay),(function(e){"use strict";e.addModule("overlayPopup");const t=[{id:"#js-change-context-btn",php:"change-context.php",close:".close-icon-btn"},{id:"#copy-edit-history-btn",php:"previous-history-elements.php",close:".close-icon-btn"},{id:"#copy-edit-anterior-segment-btn",php:"previous-ed-anterior.php",close:".close-icon-btn"},{id:"#js-virtual-clinic-btn",php:"virtual-clinic.php",close:".close-icon-btn"},{id:"#js-delete-event-btn",php:"delete-event.php",close:".js-demo-cancel-btn"},{id:"#js-close-element-btn",php:"close-element.php",close:".js-demo-cancel-btn"},{id:"#js-add-new-event",php:"add-new-event.php",close:".close-icon-btn"},{id:"#js-idg-preview-correspondence",php:"letter-preview.php",close:".close-icon-btn"},{id:"#js-idg-exam-complog",php:"exam-va-COMPlog.php",close:".close-icon-btn"},{id:"#js-duplicate-event-btn",php:"duplicate-event-warning.php",close:".close-icon-btn"},{id:"#js-idg-worklist-ps-add",php:"worklist-PS.php",close:".close-icon-btn"},{id:"#analytics-change-filters",php:"analytics-filters.php",close:".close-icon-btn"},{id:"#js-idg-add-new-contact-popup",php:"add-new-contact.php",close:".close-icon-btn"},{id:"#js-idg-admin-queset-demo",php:"admin-add-queue.php",close:".close-icon-btn"}],n=(t,n,o)=>{e.registerForClick(t,()=>{e.xhr("/idg-php/v3/_load/"+n).then(t=>{const n=document.createElement("div");n.className="oe-popup-wrap",n.innerHTML=t,n.querySelector(o).addEventListener("mousedown",t=>{t.stopPropagation(),e.removeElement(n)},{once:!0}),e.appendTo("body",n)}).catch(e=>console.log("overlayPopup failed to load",e))})};for(let e=0,o=t.length;e<o;e++){let o=t[e];null!==document.querySelector(o.id)&&n(o.id,o.php,o.close)}})(bluejay),(function(e){"use strict";e.addModule("patientPopups");const t=()=>({show:function(){this.open||(this.open=!0,s(this),this.popup.style.display="block")}}),n=e=>(e.open=!1,e.isLocked=!1,Object.assign(e,{changeState:function(){this.open?this.isLocked?(this.isLocked=!1,this.hide()):this.makeLocked():(this.makeLocked(),this.over())}},{over:function(){this.btn.classList.add("active"),this.show()}},{out:function(){this.btn.classList.remove("active"),this.hide()}},{makeLocked:function(){this.isLocked=!0,this.btn.classList.add("open")}},t(),{hide:function(){!1===this.open||this.isLocked||(this.open=!1,this.btn.classList.remove("active","open"),this.popup.style.display="none")}},{makeHidden:function(){this.open&&(this.isLocked=!1,this.hide())}})),o=[],s=e=>{o.forEach(t=>{t!=e&&t.makeHidden()})};[{btn:"#js-quicklook-btn",popup:"#patient-summary-quicklook"},{btn:"#js-demographics-btn",popup:"#patient-popup-demographics"},{btn:"#js-management-btn",popup:"#patient-popup-management"},{btn:"#js-allergies-risks-btn",popup:"#patient-popup-allergies-risks"},{btn:"#js-charts-btn",popup:"#patient-popup-charts"},{btn:"#js-patient-extra-btn",popup:"#patient-popup-trials"}].forEach(t=>{if(null!==document.querySelector(t.btn)){let s=n({btn:document.querySelector(t.btn),popup:document.querySelector(t.popup)});e.registerForClick(t.btn,()=>s.changeState()),e.registerForHover(t.btn,()=>s.over()),e.registerForExit(t.btn,()=>s.out()),o.push(s)}})})(bluejay),(function(e){"use strict";e.addModule("proView");const t=[],n=e=>({options:function(e){e.lock&&(this.pro=null),0!=e.linkID&&(this.linked=!0,this.linkedProView=s(document.querySelector("#"+e.linkID)),e.lock&&(this.linkedProView.pro=null))}}),o=e=>{let t=e.querySelector(".pro-view-btn"),o=e.querySelector(".data-pro-view"),s=e.querySelector(".data-standard-view"),i={btn:t,oei:t.querySelector(".oe-i"),pro:o,standard:s,inPro:!0,linked:!1};return Object.assign(i,{change:function(){this.inPro?(this.hideShow(this.pro,this.standard),this.icon("expand","collapse")):(this.hideShow(this.standard,this.pro),this.icon("collapse","expand")),this.linked&&this.linkedProView.change(),this.inPro=!this.inPro}},{hideShow:function(e,t){e&&(e.style.display="none"),t&&(t.style.display="block")}},{icon:function(e,t){this.oei.classList.replace(e,t)}},n())},s=e=>{let t={pro:e.querySelector(".data-pro-view"),standard:e.querySelector(".data-standard-view"),inPro:!0};return Object.assign(t,{change:function(){this.inPro?this.hideShow(this.pro,this.standard):this.hideShow(this.standard,this.pro),this.inPro=!this.inPro}},{hideShow:function(e,t){e&&(e.style.display="none"),t&&(t.style.display="block")}})};e.registerForClick(".pro-view-btn",n=>{const s=n.target;let i=e.getDataAttr(s);if(i)t[parseFloat(i)].change();else{let n=o(e.getParent(s,".pro-data-view"));n.options(JSON.parse(s.dataset.proview)),n.change(),e.setDataAttr(s,t.length),t.push(n)}})})(bluejay),(function(e){"use strict";e.addModule("problemsPlans");const t=e.nodeArray(document.querySelectorAll(".problems-plans-sortable"));if(t.length<1)return;const n=[],o=(e,t,n)=>({id:e,text:t,info:n});e.nodeArray(t[0].querySelectorAll("li")).forEach(e=>{n.push(o(n.length,e.textContent,e.querySelector(".info").getAttribute("data-tooltip-content")))}),t.forEach(t=>{e.nodeArray(t.querySelectorAll("li")).forEach((t,n)=>{e.setDataAttr(t,n)})});let s=n.length+1;const i=(e,t)=>['<span class="drag-handle"><i class="oe-i menu medium pro-theme"></i></span>',e,'<div class="metadata">','<i class="oe-i info small pro-theme js-has-tooltip" data-tooltip-content="',t,'"></i></div>','<div class="remove"><i class="oe-i remove-circle small pro-theme pad"></i></div>'].join(""),l=(o,s)=>{let l=n.findIndex(e=>e.id==o),a=n.findIndex(e=>e.id==s);n[l]=n.splice(a,1,n[l])[0],t.length>1&&t.forEach(t=>{let o=t.querySelectorAll("li");for(let t=0,s=n.length;t<s;t++){let s=n[t],l=o[t];s.id!=e.getDataAttr(l)&&(e.setDataAttr(l,s.id),l.innerHTML=i(s.text,s.info))}})};e.registerForClick(".create-new-problem-plan button",l=>{l.preventDefault();let a=e.getParent(l.target,".create-new-problem-plan").querySelector("input");if(!a||a.value.length<2)return;let r=o(s++,a.value,"Added now!");n.push(r),((e,n)=>{t.forEach(t=>{t.appendChild(e.cloneNode(!0)),p(t.lastChild)})})((t=>{const n=new DocumentFragment,o=document.createElement("li");return o.innerHTML=i(t.text,t.info),e.setDataAttr(o,t.id),n.appendChild(o),n})(r))}),e.registerForClick(".problems-plans-sortable .remove-circle",o=>{let s=e.getParent(o.target,"li"),i=0;for(;null!==(s=s.previousSibling);)i++;t.forEach(t=>{e.removeElement(t.childNodes[i])}),n.splice(i,1)}),document.addEventListener("DOMContentLoaded",()=>{t.forEach(t=>{e.nodeArray(t.querySelectorAll("li")).forEach(e=>{p(e)})})});let a=null;const r=e=>{a=e.target,e.target.parentNode.classList.add("js-sorting-list"),e.dataTransfer.setData("source",a.innerHTML)},c=e=>{e.dataTransfer.effectAllowed="move",e.dataTransfer.dropEffect="move"},d=e=>(e.preventDefault&&e.preventDefault(),!1),u=t=>{if(t.stopPropagation&&t.stopPropagation(),!1!==t.target.parentNode.classList.contains("js-sorting-list"))return t.target.parentNode.classList.remove("js-sorting-list"),a!=t.target&&(a.innerHTML=t.target.innerHTML,t.target.innerHTML=t.dataTransfer.getData("source"),l(e.getDataAttr(a),e.getDataAttr(t.target))),!1},p=e=>{e.setAttribute("draggable","true"),e.addEventListener("dragstart",r,!1),e.addEventListener("dragenter",c,!1),e.addEventListener("dragover",d,!1),e.addEventListener("drop",u,!1)}})(bluejay),(function(e){"use strict";e.addModule("reduceElementHeight");const t=[],n=e=>(e.reduced=!1,Object.assign(e,{change:function(){this.reduced?(this.elem.classList.remove("reduced-height"),this.icon.classList.replace("increase-height-orange","reduce-height")):(this.elem.classList.add("reduced-height"),this.icon.classList.replace("reduce-height","increase-height-orange")),this.reduced=!this.reduced}}));e.registerForClick(".element .js-elem-reduce .oe-i",(o,s)=>{let i=o.target,l=e.getDataAttr(i);if(l)t[l].change();else{let o=n({elem:e.getParent(i,".element"),icon:i});o.change(),e.getDataAttr(i,t.length),t.push(o)}})})(bluejay),(function(e){"use strict";e.addModule("restrictDataHeightFlag");const t="restrict-data-shown-flag",n=e.getDataAttributeName(),o=[];function s(e,t,n){this.hasScrolled=!1,this.flag=e,this.content=t,this.scrollEndPos=n,this.content.addEventListener("scroll",()=>this.scroll(),{once:!0})}s.prototype.scroll=function(t){this.hasScrolled=!0,this.flag.className+=" fade-out",setTimeout(()=>e.removeElement(this.flag),400)},s.prototype.userClick=function(){this.hasScrolled||i(this.content,this.scrollEndPos)};const i=(e,t)=>{let n=1,o=0,s=setInterval(()=>{o=Math.min(1,n/200),e.scrollTop=Math.ceil((e=>e*(2-e))(o)*t),n+=1,1==o&&clearInterval(s)},2)};(()=>{let i=e.nodeArray(document.querySelectorAll(".restrict-data-shown"));if(i.length<1)return;const l=document.createDocumentFragment(),a=document.createElement("div");a.className=t,l.appendChild(a),i.forEach(e=>{let t=e.querySelector(".restrict-data-content"),i=e.clientHeight,a=t.scrollHeight;if(a>i&&0===t.scrollTop){let r=l.cloneNode(!0),c=r.firstChild;c.setAttribute(n,o.length),e.appendChild(r),o.push(new s(c,t,a-i))}})})(),e.registerForClick("."+t,e=>{o[e.target.getAttribute(n)].userClick()})})(bluejay),(function(e){"use strict";e.addModule("sideNavSelectList");const t=e.nodeArray(document.querySelectorAll(".js-list-filter"));if(0==t.length)return;const n=e.nodeArray(document.querySelectorAll(".js-filter-group"));let o=document.querySelector(".js-list-filter.selected");const s=e=>{n.forEach(t=>{t.style.display=e})};t.forEach(e=>{e.addEventListener("click",e=>{e.preventDefault();let t=e.target;t.classList.add("selected"),(e=>{"all"==e?s("block"):(s("none"),document.querySelector("#"+e).style.display="block")})(t.dataset.list),o.classList.remove("selected"),o=t})})})(bluejay),(function(e){"use strict";if(e.addModule("sidebarQuicklookView"),null===document.querySelector("ul.events"))return;let t=null;const n=t=>{return e.getParent(t,"li").querySelector(".quicklook")},o=()=>({show:function(t){const n=JSON.parse(t.dataset.quickview);this.icon.className="oe-i-e large "+n.icon,this.titleDate.textContent=n.title+" - "+n.date,e.xhr("/idg-php/v3/_load/sidebar/quick-view/"+n.php).then(e=>{this.content.innerHTML=e,this.div.classList.remove("fade-out"),this.div.classList.add("fade-in")}).catch(e=>console.log("PHP failed to load",e))}}),s=(()=>{const t=document.createElement("div");return t.className="oe-event-quick-view",t.id="js-event-quick-view",t.innerHTML=['<div class="event-icon"><i class="oe-i-e large"></i></div>','<div class="title-date">Title - DD Mth YYYY</div>','<div class="audit-trail">Michael Morgan</div>','<div class="quick-view-content"></div>'].join(""),e.appendTo("body",t),Object.assign({div:t,titleDate:t.querySelector(".title-date"),icon:t.querySelector(".event-icon > .oe-i-e"),content:t.querySelector(".quick-view-content")},o(),{hide:function(){this.div.classList.add("fade-out"),this.div.classList.remove("fade-in")}})})();e.registerForHover(".event .event-type",e=>{(e=>{n(e).classList.add("fade-in"),t=e})(e.target),s.show(e.target)}),e.registerForExit(".event .event-type",e=>{null!=t&&(n(t).classList.remove("fade-in"),t=null),s.hide()})})(bluejay),(function(e){"use strict";e.addModule("textAreaResize");const t=e=>{let t=e.scrollHeight;t<20||(e.style.height="auto",e.style.height=t+"px")};e.extend("resizeTextArea",t),document.addEventListener("input",e=>{e.target.matches("textarea")&&t(e.target)},!0),document.addEventListener("DOMContentLoaded",()=>{e.nodeArray(document.querySelectorAll("textarea")).forEach(e=>{t(e)})})})(bluejay),(function(e){"use strict";bluejay.addModule("vcScratchPad");const t=document.querySelector("#oe-vc-scratchpad");if(null===t)return;let n,o;t.addEventListener("dragstart",e=>{e.dataTransfer.dropEffect="move";let t=e.target.getBoundingClientRect();n=e.clientX-t.left,o=e.clientY-t.top},!1),t.addEventListener("dragend",e=>{let s=Math.round(e.clientY-o),i=Math.round(e.clientX-n);s=s<1?1:s,i=i<1?1:i,t.style.top=s+"px",t.style.left=i+"px"},!1)})();